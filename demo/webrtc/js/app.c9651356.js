(function(e){function t(t){for(var i,a,s=t[0],c=t[1],d=t[2],l=0,h=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&h.push(n[a][0]),n[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(h.length)h.shift()();return o.push.apply(o,d||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],i=!0,s=1;s<r.length;s++){var c=r[s];0!==n[c]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=r[0]))}return e}var i={},n={app:0},o=[];function a(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=i,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(r,i,function(t){return e[t]}.bind(null,i));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var u=c;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var i=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"CaptureVideo"}},[r("div",{staticClass:"getUserMediaWay"},[r("p",[e._v("（1）getUserMedia捕获视频方式，支持Chrome、Safari、安卓微信，视频体积较小")]),r("p",[e._v("视频大小："+e._s(e.getUserMediaVideoSize)+"kb")]),r("div",{staticClass:"video"},[r("video",{directives:[{name:"show",rawName:"v-show",value:!e.showVideo,expression:"!showVideo"}],ref:"video",staticClass:"capture",attrs:{autoplay:"",muted:""},domProps:{muted:!0}})]),r("div",{staticClass:"video"},[r("video",{directives:[{name:"show",rawName:"v-show",value:e.showVideo,expression:"showVideo"}],attrs:{src:e.currVideo,controls:""}})]),r("div",{staticClass:"controller"},[r("div",{staticClass:"row"},[e.showVideo||e.recording?e._e():r("div",{staticClass:"btn",on:{click:e.record}},[e._v("录制")]),e.recording?r("div",{staticClass:"btn",on:{click:e.stop}},[e._v("停止")]):e._e(),e.showVideo?r("div",{staticClass:"btn",on:{click:e.recordAgain}},[e._v("重录")]):e._e(),e.showVideo?r("div",{staticClass:"btn",on:{click:e.saveAndExit}},[e._v("保存")]):e._e()]),e.showVideo||e.recording?e._e():r("div",{staticClass:"row camera"}),e.recording?r("div",{staticClass:"row"},[r("div",[e._v("剩余录制时间 "+e._s(Math.floor(e.remainTime/60))+":"+e._s(Math.floor(e.remainTime%60)))])]):e._e()]),r("c-Loading",{directives:[{name:"show",rawName:"v-show",value:e.uploading,expression:"uploading"}],attrs:{text:"视频上传中, 请稍等..."}})],1),r("div",{staticClass:"inputWay"},[r("p",[e._v("（2）传统input上传视频方式，全支持，视频体积较大")]),r("p",[e._v("视频大小："+e._s(e.inputVideoSize)+"kb")]),r("input",{attrs:{placeholder:"选择视频",capture:"user",type:"file",accept:"video/*"},on:{change:function(t){return e.inputChange(t)}}})])])},o=[],a=(r("4160"),r("d3b7"),r("3ca3"),r("159b"),r("ddb0"),r("2b3d"),r("96cf"),r("1da1")),s=r("5530"),c=r("2f62"),d={name:"CaptureVideo",data:function(){return{media:{width:1080,height:720},camera:!0,cameras:[],mediaOptions:{audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:"video/webm;codecs=h264"},chunks:[],recording:!1,currVideo:null,currBlob:null,recorder:null,stream:null,uploading:!1,showVideo:!1,interval:null,totalTime:180,remainTime:180,getUserMediaVideoSize:0,inputVideoSize:0}},computed:Object(s["a"])({},Object(c["a"])({chosenChapter:function(e){return e.chapter.chosen}})),mounted:function(){return navigator.mediaDevices?window.MediaRecorder?(this.video=this.$refs.video,void this.getDevices()):(alert("您的浏览器不支持录音"),void this.$router.back()):(alert("您的浏览器不支持获取用户设备"),void this.$router.back())},methods:{getDevices:function(){navigator.mediaDevices.enumerateDevices().then(this.gotDevices).then(this.requestAccess).catch((function(e){alert("getDevices error: "+e)}))},gotDevices:function(e){for(var t=0;t!==e.length;++t){var r=e[t];"videoinput"===r.kind&&this.cameras.push({value:r.deviceId,kind:r.kind,label:r.label||"camera "+(this.cameras.length+1)})}},requestAccess:function(){var e=this;this.stream&&this.stream.getTracks().forEach((function(e){e.stop()}));var t={audio:!0,video:{width:this.media.height,height:this.media.width,frameRate:{ideal:60,min:10},facingMode:this.camera?"environment":"user"}};navigator.mediaDevices.getUserMedia(t).then((function(t){e.recorder=new window.MediaRecorder(t,e.mediaOptions),e.stream=t,e.video.srcObject=t,e.recorder.ondataavailable=e.getRecordingData,e.recorder.onstop=e.saveRecordingData}),(function(e){alert(e)}))},getRecordingData:function(e){this.chunks.push(e.data)},saveRecordingData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.recording=!1,!e.showVideo){t.next=8;break}return r=new Blob(e.chunks,{type:"video/webm;codecs=h264"}),e.currBlob=r,e.currVideo=URL.createObjectURL(r),e.chunks=[],t.next=8,e.save();case 8:case"end":return t.stop()}}),t)})))()},record:function(){var e=this;this.recording=!0,this.recorder.start(),this.interval=setInterval((function(){--e.remainTime,e.remainTime<=0&&(clearInterval(e.interval),e.remainTime=e.totalTime,e.stop())}),1e3)},recordAgain:function(){this.showVideo=!1,this.currVideo=null,this.record()},stop:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:clearInterval(e.interval),e.remainTime=e.totalTime,e.showVideo=!0,e.recorder.stop();case 4:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("save"),console.log(e.currBlob),e.getUserMediaVideoSize=Math.round(e.currBlob.size/1024);case 3:case"end":return t.stop()}}),t)})))()},saveAndExit:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log("此处调用上传视频接口"),e.$router.back();case 2:case"end":return t.stop()}}),t)})))()},switchChange:function(){this.recording&&(this.showVideo=!1,this.recorder.stop()),this.currVideo=null,this.requestAccess()},inputChange:function(e){var t=e.target.files[0];this.inputVideoSize=Math.round(t.size/1024)}}},u=d,l=(r("6248"),r("2877")),h=Object(l["a"])(u,n,o,!1,null,"0c93beec",null),v=h.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(v)}}).$mount("#app")},6248:function(e,t,r){"use strict";var i=r("d48b"),n=r.n(i);n.a},d48b:function(e,t,r){}});
//# sourceMappingURL=app.c9651356.js.map